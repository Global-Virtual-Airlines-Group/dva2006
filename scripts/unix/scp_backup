#!/bin/bash
# SCP database backup script
# Copyright 2007, 2008 Global Virtual Airlines Group. All Rights Reserved.
#
# To get automated SSH working, create an SSH key for the user and then copy id_rsa.pub to the
# remote user's home directory ~/.ssh/authorized_keys
#

USER="dva"
if [ "$2" != "" ]; then
	USER="$2"
fi

# Back up base files
scp /home/backup/cfg/*.tar.gz $USER@$1:~/cfg
scp /home/backup/db/create_tables.tar.bz2 $USER@$1:~/db
scp /home/backup/db/*.sql.bz2 $USER@$1:~/db

# Backup logs via rsync
cd /home/backup
rsync -avr --delete logs $USER@$1:~
rsync -avr --delete --exclude=svn.revision_base svn $USER@$1:~

# Exit with success
exit 0
